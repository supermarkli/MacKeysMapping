# MacKeysMapping

使用 AutoHotkey v2.0 在 Windows 上实现 Mac 键位布局映射。

## 功能概述

- 将 **Alt** 键模拟为 Mac 的 **Cmd** 键
- 支持**远程 Mac 模式**（通过 RDP 连接时）和**本地 Windows 模式**自动切换
- 单击 **LAlt** 发送 **Win** 键（打开开始菜单）
- 支持多种应用专属快捷键

## 使用方式

1. 双击运行 `MacKeys.ahk` 脚本
2. 系统托盘区会出现 AHK 图标
3. 右键图标可退出或重新加载脚本

## 快捷键映射

### 本地 Windows 模式（Alt 模拟 Cmd）

#### 基础编辑操作
| 快捷键 | 功能 |
|--------|------|
| `Alt + C` | 复制 |
| `Alt + V` | 粘贴 |
| `Alt + X` | 剪切 |
| `Alt + Z` | 撤销 |
| `Alt + Shift + Z` | 重做 |
| `Alt + A` | 全选 |

#### 文件操作
| 快捷键 | 功能 |
|--------|------|
| `Alt + S` | 保存 |
| `Alt + N` | 新建 |
| `Alt + W` | 关闭 |
| `Alt + P` | 搜索/打印 |
| `Alt + ,` | 打开菜单 |

#### 文本编辑
| 快捷键 | 功能 |
|--------|------|
| `Alt + B` | 加粗 |
| `Alt + F` | 查找 |
| `Alt + H` | 替换 |
| `Alt + /` | 注释 |
| `Alt + [` | 反缩进 |
| `Alt + Shift + K` | 插入代码块 |

#### 浏览器/标签页
| 快捷键 | 功能 |
|--------|------|
| `Alt + T` | 新建标签页 |
| `Alt + R` | 刷新 |

#### 缩放控制
| 快捷键 | 功能 |
|--------|------|
| `Alt + =` | 放大 |
| `Alt + -` | 缩小 |
| `Alt + 0` | 恢复大小 |

#### 光标移动
| 快捷键 | 功能 |
|--------|------|
| `Alt + Left` | 光标移至行首 |
| `Alt + Right` | 光标移至行尾 |
| `Alt + Up` | 光标移至文档头 |
| `Alt + Down` | 光标移至文档尾 |

#### 文本选择（配合 Shift）
| 快捷键 | 功能 |
|--------|------|
| `Alt + Shift + Left` | 选中至行首 |
| `Alt + Shift + Right` | 选中至行尾 |
| `Alt + Shift + Up` | 选中至文档头 |
| `Alt + Shift + Down` | 选中至文档尾 |

#### 系统快捷键
| 快捷键 | 功能 |
|--------|------|
| `Alt + E` | 打开资源管理器 |
| `Alt + Space` | 聚焦搜索（延迟触发 Win+S）|

#### Win 键特殊映射
| 快捷键 | 功能 |
|--------|------|
| `Win + Z` | 自动换行（发送 Alt+Z）|
| `Win + 1` | 截图并复制 |
| `Win + 2` | 贴图 |
| `Win + 3` | 截图 |

### 远程 Mac 模式（通过 RDP 连接时）

当检测到从 `zihao-macbook` 通过 RDP 连接时自动激活。

| 快捷键 | 功能 |
|--------|------|
| `Alt + Tab` | 任务切换（发送 Win+Tab）|

#### Win 键映射（远程模式）
| 快捷键 | 功能 |
|--------|------|
| `Win + /` | 斜杠（发送 Ctrl+/）|
| `Win + B` | 加粗 |
| `Win + S` | 保存 |
| `Win + -` | 缩小 |
| `Win + =` | 放大 |
| `Win + P` | 打印 |
| `Win + [` | 反缩进 |
| `Win + T` | 新建标签页 |
| `Win + Shift + K` | 插入代码块 |

### 应用专属快捷键

#### Typora
| 快捷键 | 功能 |
|--------|------|
| `Alt + 1~5` | 设置 1~5 级标题 |

#### 浏览器（Chrome/Edge/Firefox）
| 快捷键 | 功能 |
|--------|------|
| `Alt + Left` | 后退 |
| `Alt + Right` | 前进 |

#### VS Code
| 快捷键 | 功能 |
|--------|------|
| `Alt + Shift + P` | 命令面板 |
| `Alt + G` | 跳转行号 |

## 技术实现

- 使用 `WTSQuerySessionInformationW` API 检测 RDP 客户端名称
- 使用 `#HotIf` 指令实现条件触发
- 使用 `~` 前缀实现单击检测（Alt 单击发送 Win 键）
